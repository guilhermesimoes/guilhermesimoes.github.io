<!DOCTYPE html>
<meta charset="utf-8">
<style>
html, body {
  height: 100%;
  margin: 0;
}

.container {
  height: 100%;
  display: flex;
  justify-content: space-evenly;
  align-items: center;
  color: rgba(237, 75, 26, 0.82);
}

input[type="checkbox"] {
  margin: 0;
  width: 10em;
  height: 10em;
}
</style>
<body>
<div class="container">
  <handdrawn-checkbox><input type="checkbox" checked /></handdrawn-checkbox>

  <handdrawn-checkbox></handdrawn-checkbox>
</div>

<script type="text/javascript">
"use strict";

var template = document.createElement('template');

template.innerHTML = `
  <style>
    :host {
      position: relative;
      display: inline-block;
    }

    :host svg {
      position: absolute;
      pointer-events: none;
      border: 1px solid black;
      stroke-linecap: round;
      stroke-width: 0.5px;
    }

    ::slotted(input) {
      opacity: 0;
    }
  </style>
  <svg viewbox="0 0 10 10" stroke="currentColor">
    <path></path>
    <path></path>
  </svg>
  <slot></slot>
`;

class HandDrawnCheckbox extends HTMLElement {
  constructor() {
    super();
    var checkbox = this.querySelector('input[type="checkbox"]');
    if (!checkbox) {
      var defaultCheckbox = document.createElement('input');
      defaultCheckbox.setAttribute('type', 'checkbox');
      this.appendChild(defaultCheckbox);
    }
  }

  connectedCallback() {
    var checkbox = this.querySelector('input[type="checkbox"]');
    var templateClone = template.content.cloneNode(true);
    var pathEls = templateClone.querySelectorAll('path');
    toggleVisibility(pathEls, checkbox);

    var shadowRoot = this.attachShadow({ mode: 'open' });
    shadowRoot.appendChild(templateClone);

    checkbox.addEventListener('change', function() {
      toggleVisibility(pathEls, this)
    });
  }
}

function toggleVisibility(lines, checkbox) {
  var [line1, line2] = lines;

  if (checkbox.checked) {
    line1.setAttribute('d', `M${getPointFromRange(0.5, 1.5)} ${getPointFromRange(0.5, 1.5)}L${getPointFromRange(8.5, 9.5)} ${getPointFromRange(8.5, 9.5)}`);
    line2.setAttribute('d', `M${getPointFromRange(8.5, 9.5)} ${getPointFromRange(0.5, 1.5)}L${getPointFromRange(0.5, 1.5)} ${getPointFromRange(8.5, 9.5)}`);
    line1.style.strokeDasharray = line1.style.strokeDashoffset = Math.ceil(line1.getTotalLength()) + 1;
    line2.style.strokeDasharray = line2.style.strokeDashoffset = Math.ceil(line2.getTotalLength()) + 1;

    setTimeout(() => {
      line1.style.transition = line2.style.transition = 'stroke-dashoffset 200ms ease';
      line2.style['transition-delay'] = '200ms';
      line1.style.strokeDashoffset = line2.style.strokeDashoffset = 0;
    }, 10);
  } else {
    line1.style.strokeDashoffset = Math.ceil(line1.getTotalLength()) + 1;
    line2.style.strokeDashoffset = Math.ceil(line2.getTotalLength()) + 1;
  }
}

function getPointFromRange(start, end) {
  var diff = end - start;
  return +(start + Math.random() * diff).toFixed(2);
}

customElements.define('handdrawn-checkbox', HandDrawnCheckbox);
</script>
</body>
